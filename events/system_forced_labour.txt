namespace = forced_labour_system

#Create slaves
forced_labour_system.1 = {
	type = country_event
	hidden = yes

	trigger = {
		
		#Has slavery
		OR = {
			has_law = law_type:law_slavery_cultural
			has_law = law_type:law_slavery_political
		}
		
	}

	immediate = {
		
		#Convert pops into slaves
		if = {
			limit = { has_law = law_type:law_slavery_cultural }
			random_scope_pop = {
				limit = {
					pop_is_discriminated = yes
				}
				change_poptype = pop_type:slaves
			}
		}
		if = {
			limit = { has_law = law_type:law_slavery_political }
			random_scope_pop = {
				limit = {
					OR = { 
						AND = { 
							pop_is_discriminated = no
							pop_radical_fraction < 0.20
						}
						AND = { 
							pop_is_discriminated = yes
							pop_radical_fraction < 0.10
						}
					}
				}
				change_poptype = pop_type:slaves
			}
		}
		
		#Free slaves
		random_scope_pop = {
			limit = {
				is_pop_type = slaves
				pop_is_discriminated = no
				pop_radical_fraction < 0.20
			}
			if = {
				limit = {
					is_employed = yes
				}
				change_poptype = workplace.type.slaves_role
			}
			else = {
				change_poptype = pop_type:laborers
			}
		}
		
	}

}

#Remove slaves
forced_labour_system.2 = {
	type = country_event
	hidden = yes

	trigger = {
		
		#DEBUG
		
	}

	immediate = {
		
		#Remove slaves
		custom_tooltip = {
			text = liberate_slaves_tt
			liberate_slaves = yes
		}
		
	}

}